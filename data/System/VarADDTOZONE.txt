%META:TOPICINFO{author="ProjectContributor" comment="save topic" date="1266224965" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="Macros"}%
#VarADDTOZONE
---+++ ADDTOZONE

<verbatim class="tml">
%ADDTOZONE{
  "zone"
  ...
}%
</verbatim>

_Zones_ are specific places in the output HTML that are marked in the source templates using the [[VarRENDERZONE][RENDERZONE]] macro. Zones are used to collect various materials together, such as Javascript and CSS, that must be included in the output HTML in a specific order, and in a specific place. Each =ADDTOZONE= call can be identified by a _unique identifier_, and you can state dependencies on other identifiers. In this way you can constrain the order in which they are expanded in the output.

There are always at least two zones, =head= and =body= - see [[#HeadAndBody][below]] for more information on how to use these standard zones. You can create as many additional zones as you like. Interesting use cases in wiki applications:
   * create a =sidebar= zone to add widgets
   * create a =toolbar= zone to add buttons icons

Parameters:
   * ="zone"= optional, comma-separated list of the names of zones that
   the content should be added to. Defaults to =head=.
   * =tag="id"= optional, =unique identifier= for this =ADDTOZONE= call, to be used in =requires= in other =ADDTOZONE= calls,
   * =requires="..."= comma-separated list of =unique identifiers= for other =ADDTOZONE= calls that must be expanded before the text from this call.
   * =text="..."= optional, text to be added to the named zone, mutually exclusive with =topic=
   * =topic="..."= optional, full qualified web-topic name that contains the text to be added, mutually exclusive with =text=
   * =section="..."= optional, section of the =topic= to be added,
     defaults to the default section between STARTINCLUDE and
     STOPINCLUDE

Using =topic= and =section= is actually a short form of 
<verbatim class="tml">
%ADDTOZONE{
   "myzone"
   text="$percntINCLUDE{\"topic\" section=\"section\" warn=\"off\"}$percnt"
}%
</verbatim>

#HeadAndBody
*How to use the =head= and =body= zones*

Notionally the =head= and =body= zones correspond to the end of the HTML =&lt;HEAD&gt; tag and the end of the BODY tag respectively. Normally you should add CSS (and other HTML =&lt;HEAD&gt; content, such as =meta=) to the =head= zone, and Javascript to the =body= zone. There is a setting in =configure=, ={OptimizePageLayout}=, that controls what happens next. First, dependencies between the individual =ADDTOZONE= statements are resolved *within each zone*. Then, if ={OptimizePageLayout}= is enabled, the =head= content is added to the =&lt;HEAD&gt;, and the =body= content is added to the BODY. However, if ={OptimizePageLayout}= is _disabled_ (the default), both the =head= and =body= zones will be added to the HTML =&lt;HEAD&gt;.

For this reason you must be careful to:
   1 Only add HTML to the body zone _that is also legal in the =&lt;HEAD&gt;_
   1 Ensure that no =head= content (and no inline Javascript) depends on =body= content. Any such dependency will be _silently ignored_.
   1 Make sure that all inline JavaScript code in the topic (if it is allowed)
     is added to the page using
     =%<nop>ADDTOZONE{"body"...requires="library-tag"}%=
     with the appropriate library-tag to guarantee a correct load order.

See also [[VarRENDERZONE][RENDERZONE]]
